{"version":3,"sources":["thread.js"],"names":["e","exports","module","define","amd","f","window","global","self","thread","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"_","workerSrc","eventMethod","addEventListener","messageEvent","removeEventListener","FakeWorker","id","this","_terminated","listeners","_create","_setupListeners","_initialize","prototype","iframe","document","createElement","style","display","body","appendChild","_subscribeListeners","type","eventHandler","data","owner","each","fn","isFn","_eventHandler","_unsubscribeListeners","_getWindow","win","contentWindow","wEval","eval","execScript","msg","getSource","pool","push","index","splice","indexOf","postMessage","origin","getLocation","terminate","removeChild","./utils","./worker",2,"store","Thread","ThreadFactory","options","VERSION","create","Task","total","all","running","idle","flush","killAll","terminateAll","killIdle","terminateIdle","./store","./thread",3,"num","threadRun","run","threads","findBestAvailableThread","offset","pending","terminated","newThread","runTask","args","task","apply","exec","arguments","nextThread","count","kill","threadPool","isPool",4,"toInteger","Math","floor","abs","Array","sought","Object","max","buf","slice","remove","getByStatus","typeBuf","arr",5,"env","uuid","worker","time","memoized","error","success","end","intervalCheckTime","bind","set","extend","TypeError","isArr","isObj","serializeMap","now","maxTaskDelay","checkInterval","_tasks","cleanTask","addWorkerMessageListener","sendMessage","then","errorFn","pushStateHandler","finish","getValue","flushed","src","toString","maxDelay","_timer","setInterval","clearTimer","checkTaskDelay","onMessage","dispathEvent","value","dispatcher","recur","shift","createError","err","name","errorName","stack","errorStack","_latestTask","clearInterval","isValidEvent","handler","ev","triggerMessage","split",6,"Worker","URL","webkitURL","hasWorkers","isIE","test","navigator","userAgent","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","setOptions","createThread","idleTime","defaults","evalPath","silent","defer","fnName","send","concat","flushTasks","tasks","start","init","_setOptions","sleep","on","off","namespace","createBlob","blob","Blob","append","getBlob","createObjectURL","./fake-worker","./pool","./task",7,"toStr","hasOwn","hasOwnProperty","isArrayNative","isArray","Date","getTime","obj","toArr","setTimeout","target","key","undefined","random","location","protocol","hostname","port",8,"$$evalExpr","expr","isolated","isWorker","importFn","importScripts","appendScripts","ready","fnRegex","urlProtocolRegex","queue","scriptsLoad","intervalId","mapFields","replace","forEach","waitToDocumentReady","readyState","onreadystatechange","appendScript","head","getElementsByTagName","script","onload","scriptsLoadTimer","loadScripts","map","makePathFullUrl","path","requireFn","parent","sendError","message","sendSuccess","val","done","process","result","ctx","doJob","extendEnv"],"mappings":"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"}